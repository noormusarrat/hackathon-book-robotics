"use strict";(globalThis.webpackChunkmy_website=globalThis.webpackChunkmy_website||[]).push([[2752],{7398:(n,e,i)=>{i.r(e),i.d(e,{assets:()=>l,contentTitle:()=>s,default:()=>u,frontMatter:()=>r,metadata:()=>t,toc:()=>c});const t=JSON.parse('{"id":"module-2-simulation/examples/index","title":"Module 2 Example Code - Simulation Environments","description":"1. Basic Gazebo Robot Spawn Example","source":"@site/docs/module-2-simulation/examples/index.md","sourceDirName":"module-2-simulation/examples","slug":"/module-2-simulation/examples/","permalink":"/hackathon-book-robotics/docs/module-2-simulation/examples/","draft":false,"unlisted":false,"editUrl":"https://github.com/noormusarrat/hackathon-book-robotics/edit/main/docs/module-2-simulation/examples/index.md","tags":[],"version":"current","sidebarPosition":16,"frontMatter":{"title":"Module 2 Example Code - Simulation Environments","sidebar_position":16},"sidebar":"tutorialSidebar","previous":{"title":"Module 2 Exercises - Simulation Environments","permalink":"/hackathon-book-robotics/docs/module-2-simulation/exercises/"},"next":{"title":"Chapter 15: Introduction to NVIDIA Isaac","permalink":"/hackathon-book-robotics/docs/module-3-isaac/chapter-1"}}');var o=i(4848),a=i(8453);const r={title:"Module 2 Example Code - Simulation Environments",sidebar_position:16},s="Module 2 Example Code: Simulation Environments",l={},c=[{value:"1. Basic Gazebo Robot Spawn Example",id:"1-basic-gazebo-robot-spawn-example",level:2},{value:"URDF Model Definition",id:"urdf-model-definition",level:3},{value:"Gazebo Launch File",id:"gazebo-launch-file",level:3},{value:"2. Unity-ROS Connection Example",id:"2-unity-ros-connection-example",level:2},{value:"Unity Robot Controller Script",id:"unity-robot-controller-script",level:3},{value:"Unity Visualization Script",id:"unity-visualization-script",level:3},{value:"3. Digital Twin Core Example",id:"3-digital-twin-core-example",level:2},{value:"Digital Twin Core Node",id:"digital-twin-core-node",level:3},{value:"4. Simulation Configuration Manager Example",id:"4-simulation-configuration-manager-example",level:2},{value:"Configuration Manager Node",id:"configuration-manager-node",level:3},{value:"5. Transfer Validation System Example",id:"5-transfer-validation-system-example",level:2},{value:"Transfer Validation Node",id:"transfer-validation-node",level:3},{value:"6. Simulation World File Example",id:"6-simulation-world-file-example",level:2},{value:"Gazebo World with Humanoid Environment",id:"gazebo-world-with-humanoid-environment",level:3},{value:"7. Controller Configuration Example",id:"7-controller-configuration-example",level:2},{value:"ROS 2 Controller Configuration",id:"ros-2-controller-configuration",level:3},{value:"APA Citations",id:"apa-citations",level:2}];function m(n){const e={code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",pre:"pre",ul:"ul",...(0,a.R)(),...n.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(e.header,{children:(0,o.jsx)(e.h1,{id:"module-2-example-code-simulation-environments",children:"Module 2 Example Code: Simulation Environments"})}),"\n",(0,o.jsx)(e.h2,{id:"1-basic-gazebo-robot-spawn-example",children:"1. Basic Gazebo Robot Spawn Example"}),"\n",(0,o.jsx)(e.h3,{id:"urdf-model-definition",children:"URDF Model Definition"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-xml",children:'<?xml version="1.0" ?>\n<robot name="simple_humanoid" xmlns:xacro="http://www.ros.org/wiki/xacro">\n\n  \x3c!-- Materials --\x3e\n  <material name="blue">\n    <color rgba="0.0 0.0 0.8 1.0"/>\n  </material>\n  <material name="red">\n    <color rgba="0.8 0.0 0.0 1.0"/>\n  </material>\n  <material name="green">\n    <color rgba="0.0 0.8 0.0 1.0"/>\n  </material>\n  <material name="grey">\n    <color rgba="0.5 0.5 0.5 1.0"/>\n  </material>\n\n  \x3c!-- Base link --\x3e\n  <link name="base_link">\n    <inertial>\n      <mass value="10.0"/>\n      <origin xyz="0 0 0.1"/>\n      <inertia ixx="0.1" ixy="0" ixz="0" iyy="0.1" iyz="0" izz="0.1"/>\n    </inertial>\n    <visual>\n      <origin xyz="0 0 0.1"/>\n      <geometry>\n        <box size="0.3 0.2 0.2"/>\n      </geometry>\n      <material name="grey"/>\n    </visual>\n    <collision>\n      <origin xyz="0 0 0.1"/>\n      <geometry>\n        <box size="0.3 0.2 0.2"/>\n      </geometry>\n    </collision>\n  </link>\n\n  \x3c!-- Torso --\x3e\n  <link name="torso">\n    <inertial>\n      <mass value="5.0"/>\n      <origin xyz="0 0 0.25"/>\n      <inertia ixx="0.05" ixy="0" ixz="0" iyy="0.05" iyz="0" izz="0.05"/>\n    </inertial>\n    <visual>\n      <origin xyz="0 0 0.25"/>\n      <geometry>\n        <box size="0.2 0.15 0.5"/>\n      </geometry>\n      <material name="blue"/>\n    </visual>\n    <collision>\n      <origin xyz="0 0 0.25"/>\n      <geometry>\n        <box size="0.2 0.15 0.5"/>\n      </geometry>\n    </collision>\n  </link>\n\n  <joint name="base_torso_joint" type="fixed">\n    <parent link="base_link"/>\n    <child link="torso"/>\n    <origin xyz="0 0 0.2"/>\n  </joint>\n\n  \x3c!-- Head --\x3e\n  <link name="head">\n    <inertial>\n      <mass value="1.0"/>\n      <origin xyz="0 0 0.05"/>\n      <inertia ixx="0.001" ixy="0" ixz="0" iyy="0.001" iyz="0" izz="0.001"/>\n    </inertial>\n    <visual>\n      <origin xyz="0 0 0.05"/>\n      <geometry>\n        <sphere radius="0.08"/>\n      </geometry>\n      <material name="green"/>\n    </visual>\n    <collision>\n      <origin xyz="0 0 0.05"/>\n      <geometry>\n        <sphere radius="0.08"/>\n      </geometry>\n    </collision>\n  </link>\n\n  <joint name="neck_joint" type="revolute">\n    <parent link="torso"/>\n    <child link="head"/>\n    <origin xyz="0 0 0.5"/>\n    <axis xyz="0 1 0"/>\n    <limit lower="-0.5" upper="0.5" effort="10.0" velocity="2.0"/>\n  </joint>\n\n  \x3c!-- Left leg --\x3e\n  <link name="left_hip">\n    <inertial>\n      <mass value="2.0"/>\n      <origin xyz="0 0 -0.1"/>\n      <inertia ixx="0.01" ixy="0" ixz="0" iyy="0.01" iyz="0" izz="0.005"/>\n    </inertial>\n    <visual>\n      <origin xyz="0 0 -0.1"/>\n      <geometry>\n        <cylinder length="0.2" radius="0.04"/>\n      </geometry>\n      <material name="red"/>\n    </visual>\n    <collision>\n      <origin xyz="0 0 -0.1"/>\n      <geometry>\n        <cylinder length="0.2" radius="0.04"/>\n      </geometry>\n    </collision>\n  </link>\n\n  <joint name="left_hip_joint" type="revolute">\n    <parent link="base_link"/>\n    <child link="left_hip"/>\n    <origin xyz="-0.08 0 0.1"/>\n    <axis xyz="1 0 0"/>\n    <limit lower="-1.57" upper="1.57" effort="50.0" velocity="3.0"/>\n  </joint>\n\n  <link name="left_knee">\n    <inertial>\n      <mass value="1.5"/>\n      <origin xyz="0 0 -0.15"/>\n      <inertia ixx="0.008" ixy="0" ixz="0" iyy="0.008" iyz="0" izz="0.004"/>\n    </inertial>\n    <visual>\n      <origin xyz="0 0 -0.15"/>\n      <geometry>\n        <cylinder length="0.3" radius="0.035"/>\n      </geometry>\n      <material name="red"/>\n    </visual>\n    <collision>\n      <origin xyz="0 0 -0.15"/>\n      <geometry>\n        <cylinder length="0.3" radius="0.035"/>\n      </geometry>\n    </collision>\n  </link>\n\n  <joint name="left_knee_joint" type="revolute">\n    <parent link="left_hip"/>\n    <child link="left_knee"/>\n    <origin xyz="0 0 -0.2"/>\n    <axis xyz="1 0 0"/>\n    <limit lower="0" upper="2.35" effort="50.0" velocity="3.0"/>\n  </joint>\n\n  <link name="left_ankle">\n    <inertial>\n      <mass value="1.0"/>\n      <origin xyz="0 0 -0.05"/>\n      <inertia ixx="0.003" ixy="0" ixz="0" iyy="0.003" iyz="0" izz="0.002"/>\n    </inertial>\n    <visual>\n      <origin xyz="0 0 -0.05"/>\n      <geometry>\n        <box size="0.1 0.08 0.1"/>\n      </geometry>\n      <material name="red"/>\n    </visual>\n    <collision>\n      <origin xyz="0 0 -0.05"/>\n      <geometry>\n        <box size="0.1 0.08 0.1"/>\n      </geometry>\n    </collision>\n  </link>\n\n  <joint name="left_ankle_joint" type="revolute">\n    <parent link="left_knee"/>\n    <child link="left_ankle"/>\n    <origin xyz="0 0 -0.3"/>\n    <axis xyz="1 0 0"/>\n    <limit lower="-0.5" upper="0.5" effort="25.0" velocity="2.0"/>\n  </joint>\n\n  \x3c!-- Right leg (mirror of left) --\x3e\n  <link name="right_hip">\n    <inertial>\n      <mass value="2.0"/>\n      <origin xyz="0 0 -0.1"/>\n      <inertia ixx="0.01" ixy="0" ixz="0" iyy="0.01" iyz="0" izz="0.005"/>\n    </inertial>\n    <visual>\n      <origin xyz="0 0 -0.1"/>\n      <geometry>\n        <cylinder length="0.2" radius="0.04"/>\n      </geometry>\n      <material name="red"/>\n    </visual>\n    <collision>\n      <origin xyz="0 0 -0.1"/>\n      <geometry>\n        <cylinder length="0.2" radius="0.04"/>\n      </geometry>\n    </collision>\n  </link>\n\n  <joint name="right_hip_joint" type="revolute">\n    <parent link="base_link"/>\n    <child link="right_hip"/>\n    <origin xyz="0.08 0 0.1"/>\n    <axis xyz="1 0 0"/>\n    <limit lower="-1.57" upper="1.57" effort="50.0" velocity="3.0"/>\n  </joint>\n\n  <link name="right_knee">\n    <inertial>\n      <mass value="1.5"/>\n      <origin xyz="0 0 -0.15"/>\n      <inertia ixx="0.008" ixy="0" ixz="0" iyy="0.008" iyz="0" izz="0.004"/>\n    </inertial>\n    <visual>\n      <origin xyz="0 0 -0.15"/>\n      <geometry>\n        <cylinder length="0.3" radius="0.035"/>\n      </geometry>\n      <material name="red"/>\n    </visual>\n    <collision>\n      <origin xyz="0 0 -0.15"/>\n      <geometry>\n        <cylinder length="0.3" radius="0.035"/>\n      </geometry>\n    </collision>\n  </link>\n\n  <joint name="right_knee_joint" type="revolute">\n    <parent link="right_hip"/>\n    <child link="right_knee"/>\n    <origin xyz="0 0 -0.2"/>\n    <axis xyz="1 0 0"/>\n    <limit lower="0" upper="2.35" effort="50.0" velocity="3.0"/>\n  </joint>\n\n  <link name="right_ankle">\n    <inertial>\n      <mass value="1.0"/>\n      <origin xyz="0 0 -0.05"/>\n      <inertia ixx="0.003" ixy="0" ixz="0" iyy="0.003" iyz="0" izz="0.002"/>\n    </inertial>\n    <visual>\n      <origin xyz="0 0 -0.05"/>\n      <geometry>\n        <box size="0.1 0.08 0.1"/>\n      </geometry>\n      <material name="red"/>\n    </visual>\n    <collision>\n      <origin xyz="0 0 -0.05"/>\n      <geometry>\n        <box size="0.1 0.08 0.1"/>\n      </geometry>\n    </collision>\n  </link>\n\n  <joint name="right_ankle_joint" type="revolute">\n    <parent link="right_knee"/>\n    <child link="right_ankle"/>\n    <origin xyz="0 0 -0.3"/>\n    <axis xyz="1 0 0"/>\n    <limit lower="-0.5" upper="0.5" effort="25.0" velocity="2.0"/>\n  </joint>\n\n  \x3c!-- Gazebo plugin for ROS control --\x3e\n  <gazebo>\n    <plugin name="gazebo_ros2_control" filename="libgazebo_ros2_control.so">\n      <parameters>$(find my_humanoid_description)/config/humanoid_controllers.yaml</parameters>\n    </plugin>\n  </gazebo>\n\n  \x3c!-- Gazebo materials --\x3e\n  <gazebo reference="base_link">\n    <material>Gazebo/Grey</material>\n  </gazebo>\n\n  <gazebo reference="torso">\n    <material>Gazebo/Blue</material>\n  </gazebo>\n\n  <gazebo reference="head">\n    <material>Gazebo/Green</material>\n  </gazebo>\n\n  <gazebo reference="left_hip">\n    <material>Gazebo/Red</material>\n  </gazebo>\n\n  <gazebo reference="left_knee">\n    <material>Gazebo/Red</material>\n  </gazebo>\n\n  <gazebo reference="left_ankle">\n    <material>Gazebo/Red</material>\n  </gazebo>\n\n  <gazebo reference="right_hip">\n    <material>Gazebo/Red</material>\n  </gazebo>\n\n  <gazebo reference="right_knee">\n    <material>Gazebo/Red</material>\n  </gazebo>\n\n  <gazebo reference="right_ankle">\n    <material>Gazebo/Red</material>\n  </gazebo>\n\n</robot>\n'})}),"\n",(0,o.jsx)(e.h3,{id:"gazebo-launch-file",children:"Gazebo Launch File"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-xml",children:"\x3c!-- launch/humanoid_spawn.launch.py --\x3e\nfrom launch import LaunchDescription\nfrom launch.actions import DeclareLaunchArgument, IncludeLaunchDescription\nfrom launch.launch_description_sources import PythonLaunchDescriptionSource\nfrom launch.substitutions import Command, FindExecutable, LaunchConfiguration, PathJoinSubstitution\nfrom launch_ros.actions import Node\nfrom launch_ros.substitutions import FindPackageShare\n\n\ndef generate_launch_description():\n    # Declare launch arguments\n    use_sim_time = LaunchConfiguration('use_sim_time')\n    robot_description_path = LaunchConfiguration('robot_description_path')\n\n    # Declare launch arguments\n    declare_use_sim_time = DeclareLaunchArgument(\n        'use_sim_time',\n        default_value='true',\n        description='Use simulation (Gazebo) clock if true'\n    )\n\n    declare_robot_description_path = DeclareLaunchArgument(\n        'robot_description_path',\n        default_value=PathJoinSubstitution([\n            FindPackageShare('my_humanoid_description'),\n            'urdf',\n            'simple_humanoid.urdf.xacro'\n        ]),\n        description='Path to robot URDF file'\n    )\n\n    # Get URDF via xacro\n    robot_description_content = Command(\n        [\n            PathJoinSubstitution([FindExecutable(name='xacro')]),\n            ' ',\n            LaunchConfiguration('robot_description_path'),\n        ]\n    )\n    robot_description = {'robot_description': robot_description_content}\n\n    # Launch Gazebo\n    gazebo = IncludeLaunchDescription(\n        PythonLaunchDescriptionSource([\n            PathJoinSubstitution([\n                FindPackageShare('gazebo_ros'),\n                'launch',\n                'gazebo.launch.py'\n            ])\n        ]),\n    )\n\n    # Robot State Publisher\n    robot_state_publisher = Node(\n        package='robot_state_publisher',\n        executable='robot_state_publisher',\n        output='both',\n        parameters=[robot_description, {'use_sim_time': use_sim_time}],\n    )\n\n    # Spawn robot\n    spawn_entity = Node(\n        package='gazebo_ros',\n        executable='spawn_entity.py',\n        arguments=[\n            '-topic', 'robot_description',\n            '-entity', 'simple_humanoid',\n            '-x', '0.0',\n            '-y', '0.0',\n            '-z', '1.0',\n        ],\n        output='screen',\n    )\n\n    return LaunchDescription([\n        declare_use_sim_time,\n        declare_robot_description_path,\n        gazebo,\n        robot_state_publisher,\n        spawn_entity,\n    ])\n"})}),"\n",(0,o.jsx)(e.h2,{id:"2-unity-ros-connection-example",children:"2. Unity-ROS Connection Example"}),"\n",(0,o.jsx)(e.h3,{id:"unity-robot-controller-script",children:"Unity Robot Controller Script"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-csharp",children:'// Assets/Scripts/UnityRobotController.cs\nusing UnityEngine;\nusing Unity.Robotics.ROSTCPConnector;\nusing Unity.Robotics.ROSTCPConnector.MessageTypes.Std_msgs;\nusing Unity.Robotics.ROSTCPConnector.MessageTypes.Sensor_msgs;\nusing Unity.Robotics.ROSTCPConnector.MessageTypes.Geometry_msgs;\nusing System.Collections;\nusing System.Collections.Generic;\n\npublic class UnityRobotController : MonoBehaviour\n{\n    [Header("ROS Connection")]\n    public string rosIPAddress = "127.0.0.1";\n    public int rosPort = 10000;\n\n    [Header("Robot Configuration")]\n    public string jointStateTopic = "/joint_states";\n    public string commandTopic = "/joint_trajectory_controller/joint_trajectory";\n    public string imuTopic = "/imu/data";\n\n    [Header("Joint Transforms")]\n    public Transform headJoint;\n    public Transform leftHipJoint;\n    public Transform leftKneeJoint;\n    public Transform leftAnkleJoint;\n    public Transform rightHipJoint;\n    public Transform rightKneeJoint;\n    public Transform rightAnkleJoint;\n\n    private ROSConnection ros;\n    private Dictionary<string, Transform> jointMap;\n    private JointStateData currentJointState;\n\n    [System.Serializable]\n    public class JointStateData\n    {\n        public string[] names;\n        public double[] positions;\n        public double[] velocities;\n        public double[] efforts;\n    }\n\n    void Start()\n    {\n        // Initialize ROS connection\n        ros = ROSConnection.GetOrCreateInstance();\n        ros.Initialize(rosIPAddress, rosPort);\n\n        // Subscribe to topics\n        ros.Subscribe<sensor_msgs_JointState>(jointStateTopic, OnJointStateReceived);\n        ros.Subscribe<sensor_msgs_Imu>(imuTopic, OnImuReceived);\n\n        // Initialize joint mapping\n        InitializeJointMap();\n    }\n\n    void InitializeJointMap()\n    {\n        jointMap = new Dictionary<string, Transform>\n        {\n            {"head_joint", headJoint},\n            {"left_hip_joint", leftHipJoint},\n            {"left_knee_joint", leftKneeJoint},\n            {"left_ankle_joint", leftAnkleJoint},\n            {"right_hip_joint", rightHipJoint},\n            {"right_knee_joint", rightKneeJoint},\n            {"right_ankle_joint", rightAnkleJoint}\n        };\n    }\n\n    void OnJointStateReceived(sensor_msgs_JointState jointState)\n    {\n        currentJointState = new JointStateData\n        {\n            names = jointState.name,\n            positions = jointState.position,\n            velocities = jointState.velocity,\n            efforts = jointState.effort\n        };\n\n        // Update robot visualization\n        UpdateRobotVisualization();\n    }\n\n    void OnImuReceived(sensor_msgs_Imu imu)\n    {\n        // Update robot orientation based on IMU data\n        Vector3 eulerAngles = RosQuaternionToUnityEuler(imu.orientation);\n        transform.rotation = Quaternion.Euler(eulerAngles);\n    }\n\n    void UpdateRobotVisualization()\n    {\n        if (currentJointState == null || currentJointState.names == null) return;\n\n        for (int i = 0; i < currentJointState.names.Length; i++)\n        {\n            string jointName = currentJointState.names[i];\n            float jointPosition = (float)currentJointState.positions[i];\n\n            if (jointMap.ContainsKey(jointName))\n            {\n                Transform jointTransform = jointMap[jointName];\n                // Apply rotation based on joint position (assuming revolute joints)\n                jointTransform.localRotation = Quaternion.Euler(0, jointPosition * Mathf.Rad2Deg, 0);\n            }\n        }\n    }\n\n    Vector3 RosQuaternionToUnityEuler(Unity.Robotics.ROSTCPConnector.MessageTypes.Geometry_msgs.Quaternion rosQuat)\n    {\n        float x = (float)rosQuat.x;\n        float y = (float)rosQuat.y;\n        float z = (float)rosQuat.z;\n        float w = (float)rosQuat.w;\n\n        // Convert to Euler angles\n        Vector3 eulerAngles = new Vector3();\n\n        // Yaw (Z axis rotation)\n        eulerAngles.y = Mathf.Atan2(2 * (w * z + x * y), 1 - 2 * (y * y + z * z)) * Mathf.Rad2Deg;\n\n        // Pitch (Y axis rotation)\n        eulerAngles.x = Mathf.Atan2(2 * (w * y - z * x), Mathf.Sqrt(1 + 2 * (w * y - z * x) * (w * y - z * x))) * Mathf.Rad2Deg;\n\n        // Roll (X axis rotation)\n        eulerAngles.z = Mathf.Asin(2 * (w * x + y * z)) * Mathf.Rad2Deg;\n\n        return eulerAngles;\n    }\n\n    public void SendJointCommand(string jointName, float position)\n    {\n        // This would send a command to the robot\n        // Implementation depends on your specific command structure\n    }\n}\n'})}),"\n",(0,o.jsx)(e.h3,{id:"unity-visualization-script",children:"Unity Visualization Script"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-csharp",children:'// Assets/Scripts/UnityRobotVisualizer.cs\nusing UnityEngine;\nusing UnityEngine.UI;\nusing System.Collections.Generic;\n\npublic class UnityRobotVisualizer : MonoBehaviour\n{\n    [Header("Visualization Settings")]\n    public bool showTrajectory = true;\n    public bool showSensors = true;\n    public bool showForces = true;\n\n    [Header("UI Elements")]\n    public Text statusText;\n    public Text jointInfoText;\n    public Slider timeScaleSlider;\n\n    [Header("Visualization Prefabs")]\n    public GameObject trajectoryPointPrefab;\n    public GameObject sensorRangeVisual;\n\n    private LineRenderer trajectoryLine;\n    private List<Vector3> trajectoryPoints;\n    private UnityRobotController robotController;\n\n    void Start()\n    {\n        // Initialize trajectory visualization\n        InitializeTrajectory();\n\n        // Get references\n        robotController = FindObjectOfType<UnityRobotController>();\n\n        // Setup UI\n        SetupUI();\n    }\n\n    void InitializeTrajectory()\n    {\n        trajectoryLine = gameObject.AddComponent<LineRenderer>();\n        trajectoryLine.material = new Material(Shader.Find("Sprites/Default"));\n        trajectoryLine.widthMultiplier = 0.05f;\n        trajectoryLine.positionCount = 0;\n\n        trajectoryPoints = new List<Vector3>();\n    }\n\n    void SetupUI()\n    {\n        if (timeScaleSlider != null)\n        {\n            timeScaleSlider.onValueChanged.AddListener(OnTimeScaleChanged);\n            timeScaleSlider.value = 1.0f;\n        }\n    }\n\n    void OnTimeScaleChanged(float value)\n    {\n        Time.timeScale = value;\n    }\n\n    void Update()\n    {\n        // Update trajectory visualization\n        UpdateTrajectory();\n\n        // Update UI information\n        UpdateUIInformation();\n    }\n\n    void UpdateTrajectory()\n    {\n        if (!showTrajectory) return;\n\n        // Add current position to trajectory\n        Vector3 currentPosition = transform.position;\n\n        // Remove old points based on time\n        float currentTime = Time.time;\n        trajectoryPoints.Add(currentPosition);\n\n        // Limit number of points to prevent memory issues\n        if (trajectoryPoints.Count > 1000)\n        {\n            trajectoryPoints.RemoveAt(0);\n        }\n\n        // Update line renderer\n        trajectoryLine.positionCount = trajectoryPoints.Count;\n        trajectoryLine.SetPositions(trajectoryPoints.ToArray());\n    }\n\n    void UpdateUIInformation()\n    {\n        if (statusText != null)\n        {\n            statusText.text = $"Time Scale: {Time.timeScale:F2}x\\n" +\n                             $"Trajectory Points: {trajectoryPoints.Count}\\n" +\n                             $"Status: Connected";\n        }\n\n        if (jointInfoText != null && robotController != null)\n        {\n            var jointState = robotController.currentJointState;\n            if (jointState != null && jointState.names != null)\n            {\n                string jointInfo = "Joint Positions:\\n";\n                for (int i = 0; i < Mathf.Min(5, jointState.names.Length); i++)\n                {\n                    jointInfo += $"{jointState.names[i]}: {jointState.positions[i]:F3}\\n";\n                }\n                jointInfoText.text = jointInfo;\n            }\n        }\n    }\n\n    public void ToggleTrajectory()\n    {\n        showTrajectory = !showTrajectory;\n        trajectoryLine.enabled = showTrajectory;\n    }\n\n    public void ClearTrajectory()\n    {\n        trajectoryPoints.Clear();\n        trajectoryLine.positionCount = 0;\n    }\n}\n'})}),"\n",(0,o.jsx)(e.h2,{id:"3-digital-twin-core-example",children:"3. Digital Twin Core Example"}),"\n",(0,o.jsx)(e.h3,{id:"digital-twin-core-node",children:"Digital Twin Core Node"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-python",children:'#!/usr/bin/env python3\n# digital_twin_core_example.py\n\nimport rclpy\nfrom rclpy.node import Node\nfrom sensor_msgs.msg import JointState, Imu\nfrom std_msgs.msg import Float64MultiArray, String\nfrom geometry_msgs.msg import Pose, Twist\nimport numpy as np\nimport threading\nfrom collections import deque\nfrom dataclasses import dataclass\nfrom typing import List\n\n\n@dataclass\nclass RobotState:\n    """Data structure for robot state in digital twin"""\n    joint_positions: List[float]\n    joint_velocities: List[float]\n    joint_efforts: List[float]\n    imu_orientation: List[float]  # x, y, z, w quaternion\n    imu_angular_velocity: List[float]  # x, y, z\n    imu_linear_acceleration: List[float]  # x, y, z\n    pose: Pose\n    velocity: Twist\n\n\nclass DigitalTwinCore(Node):\n    def __init__(self):\n        super().__init__(\'digital_twin_core\')\n\n        # Publishers\n        self.twin_state_pub = self.create_publisher(\n            Float64MultiArray,\n            \'digital_twin/state\',\n            10\n        )\n\n        # Subscribers\n        self.joint_state_sub = self.create_subscription(\n            JointState,\n            \'/joint_states\',\n            self.joint_state_callback,\n            10\n        )\n\n        self.imu_sub = self.create_subscription(\n            Imu,\n            \'/imu/data\',\n            self.imu_callback,\n            10\n        )\n\n        # Timer for twin update\n        self.twin_timer = self.create_timer(0.01, self.twin_update_loop)  # 100 Hz\n\n        # Internal state\n        self.current_state = RobotState(\n            joint_positions=[],\n            joint_velocities=[],\n            joint_efforts=[],\n            imu_orientation=[0.0, 0.0, 0.0, 1.0],\n            imu_angular_velocity=[0.0, 0.0, 0.0],\n            imu_linear_acceleration=[0.0, 0.0, 0.0],\n            pose=Pose(),\n            velocity=Twist()\n        )\n\n        self.state_history = deque(maxlen=1000)\n        self.state_lock = threading.RLock()\n\n        self.get_logger().info(\'Digital Twin Core initialized\')\n\n    def joint_state_callback(self, msg):\n        """Update joint state in digital twin"""\n        with self.state_lock:\n            self.current_state.joint_positions = list(msg.position)\n            self.current_state.joint_velocities = list(msg.velocity)\n            self.current_state.joint_efforts = list(msg.effort)\n\n    def imu_callback(self, msg):\n        """Update IMU state in digital twin"""\n        with self.state_lock:\n            self.current_state.imu_orientation = [\n                msg.orientation.x,\n                msg.orientation.y,\n                msg.orientation.z,\n                msg.orientation.w\n            ]\n            self.current_state.imu_angular_velocity = [\n                msg.angular_velocity.x,\n                msg.angular_velocity.y,\n                msg.angular_velocity.z\n            ]\n            self.current_state.imu_linear_acceleration = [\n                msg.linear_acceleration.x,\n                msg.linear_acceleration.y,\n                msg.linear_acceleration.z\n            ]\n\n    def twin_update_loop(self):\n        """Main digital twin update loop"""\n        with self.state_lock:\n            # Add current state to history\n            self.state_history.append(self.current_state)\n\n            # Publish current twin state\n            state_msg = Float64MultiArray()\n            state_msg.data = self.pack_state_for_publishing(self.current_state)\n            self.twin_state_pub.publish(state_msg)\n\n    def pack_state_for_publishing(self, state):\n        """Convert RobotState to Float64MultiArray data"""\n        data = []\n        # Add joint positions\n        data.extend(state.joint_positions)\n        # Add joint velocities\n        data.extend(state.joint_velocities)\n        # Add joint efforts\n        data.extend(state.joint_efforts)\n        # Add IMU orientation\n        data.extend(state.imu_orientation)\n        # Add IMU angular velocity\n        data.extend(state.imu_angular_velocity)\n        # Add IMU linear acceleration\n        data.extend(state.imu_linear_acceleration)\n        return data\n\n\ndef main(args=None):\n    rclpy.init(args=args)\n\n    twin_core = DigitalTwinCore()\n\n    try:\n        rclpy.spin(twin_core)\n    except KeyboardInterrupt:\n        twin_core.get_logger().info(\'Shutting down digital twin core...\')\n    finally:\n        twin_core.destroy_node()\n        rclpy.shutdown()\n\n\nif __name__ == \'__main__\':\n    main()\n'})}),"\n",(0,o.jsx)(e.h2,{id:"4-simulation-configuration-manager-example",children:"4. Simulation Configuration Manager Example"}),"\n",(0,o.jsx)(e.h3,{id:"configuration-manager-node",children:"Configuration Manager Node"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-python",children:"#!/usr/bin/env python3\n# simulation_config_manager_example.py\n\nimport rclpy\nfrom rclpy.node import Node\nfrom std_msgs.msg import String\nimport yaml\nimport json\nimport os\nfrom dataclasses import dataclass, asdict\nfrom typing import List\n\n\n@dataclass\nclass PhysicsParameters:\n    \"\"\"Physics engine parameters for humanoid simulation\"\"\"\n    solver_type: str = \"quick\"\n    solver_iterations: int = 100\n    solver_sor: float = 1.3\n    max_step_size: float = 0.001\n    real_time_factor: float = 1.0\n    gravity: List[float] = None\n\n    def __post_init__(self):\n        if self.gravity is None:\n            self.gravity = [0.0, 0.0, -9.81]\n\n\nclass SimulationConfigManager(Node):\n    def __init__(self):\n        super().__init__('simulation_config_manager')\n\n        # Publishers\n        self.config_status_pub = self.create_publisher(\n            String,\n            'simulation_config/status',\n            10\n        )\n\n        # Internal state\n        self.physics_params = PhysicsParameters()\n\n        # Load initial configuration\n        self.load_configuration()\n\n        self.get_logger().info('Simulation Configuration Manager initialized')\n\n    def load_configuration(self):\n        \"\"\"Load simulation configuration from file\"\"\"\n        config_file = 'config/simulation_config.yaml'\n        try:\n            if os.path.exists(config_file):\n                with open(config_file, 'r') as f:\n                    config_data = yaml.safe_load(f)\n\n                if 'physics' in config_data:\n                    physics_data = config_data['physics']\n                    self.physics_params = PhysicsParameters(\n                        solver_type=physics_data.get('solver_type', 'quick'),\n                        solver_iterations=physics_data.get('solver_iterations', 100),\n                        solver_sor=physics_data.get('solver_sor', 1.3),\n                        max_step_size=physics_data.get('max_step_size', 0.001),\n                        real_time_factor=physics_data.get('real_time_factor', 1.0),\n                        gravity=physics_data.get('gravity', [0.0, 0.0, -9.81])\n                    )\n\n                self.get_logger().info(f'Configuration loaded from {config_file}')\n            else:\n                self.get_logger().warn(f'Config file {config_file} not found, using defaults')\n\n        except Exception as e:\n            self.get_logger().error(f'Error loading configuration: {str(e)}')\n\n    def save_configuration(self, file_path='config/simulation_config.yaml'):\n        \"\"\"Save current configuration to file\"\"\"\n        config_data = {\n            'physics': asdict(self.physics_params)\n        }\n\n        try:\n            with open(file_path, 'w') as f:\n                yaml.dump(config_data, f, default_flow_style=False)\n            self.get_logger().info(f'Configuration saved to {file_path}')\n        except Exception as e:\n            self.get_logger().error(f'Error saving configuration: {str(e)}')\n\n\ndef main(args=None):\n    rclpy.init(args=args)\n\n    config_manager = SimulationConfigManager()\n\n    try:\n        rclpy.spin(config_manager)\n    except KeyboardInterrupt:\n        config_manager.get_logger().info('Shutting down simulation config manager...')\n        config_manager.save_configuration()\n    finally:\n        config_manager.destroy_node()\n        rclpy.shutdown()\n\n\nif __name__ == '__main__':\n    main()\n"})}),"\n",(0,o.jsx)(e.h2,{id:"5-transfer-validation-system-example",children:"5. Transfer Validation System Example"}),"\n",(0,o.jsx)(e.h3,{id:"transfer-validation-node",children:"Transfer Validation Node"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-python",children:'#!/usr/bin/env python3\n# transfer_validation_example.py\n\nimport rclpy\nfrom rclpy.node import Node\nfrom std_msgs.msg import Float64MultiArray, Bool\nfrom sensor_msgs.msg import JointState\nimport numpy as np\nfrom dataclasses import dataclass\n\n\n@dataclass\nclass TransferMetrics:\n    """Metrics for simulation to reality transfer"""\n    position_error: float = 0.0\n    velocity_error: float = 0.0\n    orientation_error: float = 0.0\n    transfer_score: float = 0.0\n\n\nclass TransferValidationSystem(Node):\n    def __init__(self):\n        super().__init__(\'transfer_validation_system\')\n\n        # Publishers\n        self.transfer_metrics_pub = self.create_publisher(\n            Float64MultiArray,\n            \'transfer_validation/metrics\',\n            10\n        )\n\n        self.transfer_status_pub = self.create_publisher(\n            Bool,\n            \'transfer_validation/status\',\n            10\n        )\n\n        # Subscribers for sim and real robot data\n        self.sim_joint_state_sub = self.create_subscription(\n            JointState,\n            \'/sim/joint_states\',\n            self.sim_joint_state_callback,\n            10\n        )\n\n        self.real_joint_state_sub = self.create_subscription(\n            JointState,\n            \'/real/joint_states\',\n            self.real_joint_state_callback,\n            10\n        )\n\n        # Timer for transfer validation\n        self.validation_timer = self.create_timer(0.1, self.transfer_validation_loop)\n\n        # Internal state\n        self.sim_joint_state = None\n        self.real_joint_state = None\n        self.current_metrics = TransferMetrics()\n\n        self.get_logger().info(\'Transfer Validation System initialized\')\n\n    def sim_joint_state_callback(self, msg):\n        """Process simulation joint state data"""\n        self.sim_joint_state = msg\n\n    def real_joint_state_callback(self, msg):\n        """Process real robot joint state data"""\n        self.real_joint_state = msg\n\n    def transfer_validation_loop(self):\n        """Main transfer validation loop"""\n        # Calculate transfer metrics\n        self.current_metrics = self.calculate_transfer_metrics()\n\n        # Publish metrics\n        metrics_msg = Float64MultiArray()\n        metrics_msg.data = [\n            self.current_metrics.position_error,\n            self.current_metrics.velocity_error,\n            self.current_metrics.orientation_error,\n            self.current_metrics.transfer_score\n        ]\n        self.transfer_metrics_pub.publish(metrics_msg)\n\n        # Publish status\n        status_msg = Bool()\n        status_msg.data = self.current_metrics.transfer_score >= 0.8  # 80% threshold\n        self.transfer_status_pub.publish(status_msg)\n\n    def calculate_transfer_metrics(self) -> TransferMetrics:\n        """Calculate comprehensive transfer metrics"""\n        metrics = TransferMetrics()\n\n        if self.sim_joint_state is None or self.real_joint_state is None:\n            return metrics\n\n        # Calculate position error (if joint names match)\n        if (self.sim_joint_state.name == self.real_joint_state.name and\n            len(self.sim_joint_state.position) == len(self.real_joint_state.position)):\n            pos_errors = []\n            for sim_pos, real_pos in zip(self.sim_joint_state.position, self.real_joint_state.position):\n                pos_errors.append(abs(sim_pos - real_pos))\n            metrics.position_error = np.mean(pos_errors) if pos_errors else 0.0\n\n        # Calculate velocity error\n        if (len(self.sim_joint_state.velocity) == len(self.real_joint_state.velocity) and\n            len(self.sim_joint_state.velocity) > 0):\n            vel_errors = []\n            for sim_vel, real_vel in zip(self.sim_joint_state.velocity, self.real_joint_state.velocity):\n                vel_errors.append(abs(sim_vel - real_vel))\n            metrics.velocity_error = np.mean(vel_errors) if vel_errors else 0.0\n\n        # Calculate transfer score (simplified)\n        position_score = max(0.0, 1.0 - metrics.position_error / 0.1)  # 0.1m tolerance\n        velocity_score = max(0.0, 1.0 - metrics.velocity_error / 1.0)  # 1.0 rad/s tolerance\n\n        metrics.transfer_score = np.mean([position_score, velocity_score])\n\n        return metrics\n\n\ndef main(args=None):\n    rclpy.init(args=args)\n\n    transfer_system = TransferValidationSystem()\n\n    try:\n        rclpy.spin(transfer_system)\n    except KeyboardInterrupt:\n        transfer_system.get_logger().info(\'Shutting down transfer validation system...\')\n    finally:\n        transfer_system.destroy_node()\n        rclpy.shutdown()\n\n\nif __name__ == \'__main__\':\n    main()\n'})}),"\n",(0,o.jsx)(e.h2,{id:"6-simulation-world-file-example",children:"6. Simulation World File Example"}),"\n",(0,o.jsx)(e.h3,{id:"gazebo-world-with-humanoid-environment",children:"Gazebo World with Humanoid Environment"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-xml",children:'<?xml version="1.0" ?>\n<sdf version="1.7">\n  <world name="humanoid_test_world">\n    \x3c!-- Include ground plane --\x3e\n    <include>\n      <uri>model://ground_plane</uri>\n    </include>\n\n    \x3c!-- Include sky --\x3e\n    <include>\n      <uri>model://sky</uri>\n    </include>\n\n    \x3c!-- Physics engine configuration --\x3e\n    <physics type="ode">\n      <max_step_size>0.001</max_step_size>\n      <real_time_factor>1.0</real_time_factor>\n      <real_time_update_rate>1000.0</real_time_update_rate>\n      <gravity>0 0 -9.8</gravity>\n      <ode>\n        <solver>\n          <type>quick</type>\n          <iters>10</iters>\n          <sor>1.3</sor>\n        </solver>\n        <constraints>\n          <cfm>0.0</cfm>\n          <erp>0.2</erp>\n          <contact_max_correcting_vel>100.0</contact_max_correcting_vel>\n          <contact_surface_layer>0.001</contact_surface_layer>\n        </constraints>\n      </ode>\n    </physics>\n\n    \x3c!-- Lighting --\x3e\n    <light name="sun" type="directional">\n      <cast_shadows>true</cast_shadows>\n      <pose>0 0 10 0 0 0</pose>\n      <diffuse>0.8 0.8 0.8 1</diffuse>\n      <specular>0.2 0.2 0.2 1</specular>\n      <attenuation>\n        <range>1000</range>\n        <constant>0.9</constant>\n        <linear>0.01</linear>\n        <quadratic>0.001</quadratic>\n      </attenuation>\n      <direction>-0.3 0.3 -1</direction>\n    </light>\n\n    \x3c!-- Simple obstacles for humanoid testing --\x3e\n    <model name="obstacle_1">\n      <pose>2 0 0.2 0 0 0</pose>\n      <link name="link">\n        <collision name="collision">\n          <geometry>\n            <box>\n              <size>0.5 0.5 0.4</size>\n            </box>\n          </geometry>\n        </collision>\n        <visual name="visual">\n          <geometry>\n            <box>\n              <size>0.5 0.5 0.4</size>\n            </box>\n          </geometry>\n          <material>\n            <ambient>0.5 0.5 0.5 1</ambient>\n            <diffuse>0.7 0.7 0.7 1</diffuse>\n            <specular>0.1 0.1 0.1 1</specular>\n          </material>\n        </visual>\n      </link>\n    </model>\n\n    <model name="obstacle_2">\n      <pose>-2 1 0.1 0 0 0</pose>\n      <link name="link">\n        <collision name="collision">\n          <geometry>\n            <cylinder>\n              <radius>0.3</radius>\n              <length>0.2</length>\n            </cylinder>\n          </geometry>\n        </collision>\n        <visual name="visual">\n          <geometry>\n            <cylinder>\n              <radius>0.3</radius>\n              <length>0.2</length>\n            </cylinder>\n          </geometry>\n          <material>\n            <ambient>0.3 0.3 0.8 1</ambient>\n            <diffuse>0.5 0.5 1.0 1</diffuse>\n            <specular>0.1 0.1 0.3 1</specular>\n          </material>\n        </visual>\n      </link>\n    </model>\n\n    \x3c!-- Ramps for testing locomotion --\x3e\n    <model name="ramp_1">\n      <pose>3 -2 0 0 0 0.5</pose>\n      <link name="link">\n        <collision name="collision">\n          <geometry>\n            <box>\n              <size>2.0 1.0 0.1</size>\n            </box>\n          </geometry>\n        </collision>\n        <visual name="visual">\n          <geometry>\n            <box>\n              <size>2.0 1.0 0.1</size>\n            </box>\n          </geometry>\n          <material>\n            <ambient>0.8 0.6 0.2 1</ambient>\n            <diffuse>1.0 0.8 0.4 1</diffuse>\n            <specular>0.3 0.2 0.1 1</specular>\n          </material>\n        </visual>\n      </link>\n    </model>\n\n  </world>\n</sdf>\n'})}),"\n",(0,o.jsx)(e.h2,{id:"7-controller-configuration-example",children:"7. Controller Configuration Example"}),"\n",(0,o.jsx)(e.h3,{id:"ros-2-controller-configuration",children:"ROS 2 Controller Configuration"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-yaml",children:"# config/humanoid_controllers.yaml\ncontroller_manager:\n  ros__parameters:\n    update_rate: 100  # Hz\n\n    joint_state_broadcaster:\n      type: joint_state_broadcaster/JointStateBroadcaster\n\n    # Position controllers for joints\n    left_hip_position_controller:\n      type: position_controllers/JointPositionController\n\n    right_hip_position_controller:\n      type: position_controllers/JointPositionController\n\n    left_knee_position_controller:\n      type: position_controllers/JointPositionController\n\n    right_knee_position_controller:\n      type: position_controllers/JointPositionController\n\n    left_ankle_position_controller:\n      type: position_controllers/JointPositionController\n\n    right_ankle_position_controller:\n      type: position_controllers/JointPositionController\n\n# Individual joint controller parameters\nleft_hip_position_controller:\n  ros__parameters:\n    joints:\n      - left_hip_joint\n    interface_name: position\n\nright_hip_position_controller:\n  ros__parameters:\n    joints:\n      - right_hip_joint\n    interface_name: position\n\nleft_knee_position_controller:\n  ros__parameters:\n    joints:\n      - left_knee_joint\n    interface_name: position\n\nright_knee_position_controller:\n  ros__parameters:\n    joints:\n      - right_knee_joint\n    interface_name: position\n\nleft_ankle_position_controller:\n  ros__parameters:\n    joints:\n      - left_ankle_joint\n    interface_name: position\n\nright_ankle_position_controller:\n  ros__parameters:\n    joints:\n      - right_ankle_joint\n    interface_name: position\n"})}),"\n",(0,o.jsx)(e.h2,{id:"apa-citations",children:"APA Citations"}),"\n",(0,o.jsxs)(e.ul,{children:["\n",(0,o.jsxs)(e.li,{children:["Koenig, N., & Howard, A. (2004). Design and use paradigms for Gazebo, an open-source multi-robot simulator. ",(0,o.jsx)(e.em,{children:"IEEE/RSJ International Conference on Intelligent Robots and Systems"}),", 2350-2354."]}),"\n",(0,o.jsxs)(e.li,{children:["Unity Technologies. (2022). Unity Robotics Hub: Documentation and tutorials. ",(0,o.jsx)(e.em,{children:"Unity Developer Documentation"}),"."]}),"\n",(0,o.jsxs)(e.li,{children:["Open Robotics. (2022). ROS 2 and Unity integration: Best practices for robotics simulation. ",(0,o.jsx)(e.em,{children:"ROS 2 Developer Guide"}),"."]}),"\n",(0,o.jsxs)(e.li,{children:["Murai, R., & Kyrki, V. (2021). Simulation to reality transfer in robotics: A survey. ",(0,o.jsx)(e.em,{children:"IEEE Access"}),", 9, 142395-142418."]}),"\n",(0,o.jsxs)(e.li,{children:["Sadeghi, F., & Levine, S. (2017). CAD2RL: Real single-image flight without a single real image. ",(0,o.jsx)(e.em,{children:"Proceedings of the International Conference on Robotics and Automation"}),"."]}),"\n",(0,o.jsxs)(e.li,{children:["Coumans, E., & Bai, Y. (2016). Mujoco: A physics engine for model-based control. ",(0,o.jsx)(e.em,{children:"IEEE International Conference on Robotics and Automation"}),"."]}),"\n"]})]})}function u(n={}){const{wrapper:e}={...(0,a.R)(),...n.components};return e?(0,o.jsx)(e,{...n,children:(0,o.jsx)(m,{...n})}):m(n)}},8453:(n,e,i)=>{i.d(e,{R:()=>r,x:()=>s});var t=i(6540);const o={},a=t.createContext(o);function r(n){const e=t.useContext(a);return t.useMemo(function(){return"function"==typeof n?n(e):{...e,...n}},[e,n])}function s(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(o):n.components||o:r(n.components),t.createElement(a.Provider,{value:e},n.children)}}}]);